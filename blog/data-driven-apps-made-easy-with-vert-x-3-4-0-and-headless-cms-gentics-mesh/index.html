<!DOCTYPE html><html lang=en><head><title>Data-driven Apps made easy with Vert.x 3.4.0 and headless CMS Gentics Mesh</title><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Eclipse Vert.x is a tool-kit for building reactive applications on the JVM." name=description><link href=https://vertx.tk/stylesheets/main.css media=screen rel=stylesheet><link href=https://vertx.tk/stylesheets/font-awesome.min.css media=screen rel=stylesheet><link href=https://vertx.tk/javascripts/styles/rainbow.min.css media=screen rel=stylesheet><!--[if lt IE 9]><script src="http://static.jboss.org/theme/js/libs/html5/pre3.6/html5.min.js"></script><![endif]--><link rel=apple-touch-icon sizes=57x57 href=https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-180x180.png><link rel=icon type=image/png href=https://vertx.tk/assets/favicons/vertx-favicon-7/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://vertx.tk/assets/favicons/vertx-favicon-7/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=https://vertx.tk/assets/favicons/vertx-favicon-7/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://vertx.tk/assets/favicons/vertx-favicon-7/favicon-16x16.png sizes=16x16><link rel=manifest href=https://vertx.tk/assets/favicons/vertx-favicon-7/manifest.json><link rel=mask-icon href=https://vertx.tk/assets/favicons/vertx-favicon-7/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#7d3194><meta name=msapplication-TileImage content=https://vertx.tk/assets/favicons/vertx-favicon-7/mstile-144x144.png><meta name=theme-color content=#ffffff><link href="https://fonts.googleapis.com/css?family=Ubuntu:400,500,700,400italic" rel=stylesheet type=text/css><link rel=alternate type=application/rss+xml title=RSS href=https://vertx.tk/feed.xml><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-30144458-1', 'auto');
    ga('create', 'UA-71153120-1', 'auto', 'tracker');
    ga('send', 'pageview');
    ga('tracker.send', 'pageview');</script><style>.page-link-to-github {
      position: relative;
      z-index: 1;
      display: inline-block;
      border: 1px solid #782B90;
      border-radius: 5px;
      color: #782B90;
      font-size: 12px;
      padding: 4px 10px;
      text-decoration: none;
      background-color: #ffffff;
    }
    .page-link-to-github:hover {
      color: #ffffff;
      border-color: #ffffff;
      background-color: #782B90;
    }

    .page-link-to-github .github-icon {
      position: absolute;
      display: inline-block;
      width: 20px;
      height: 20px;
      background-image: url('https://www.kotlincn.net/0_assets/static/css/com/layout/images/main-sprite.png');
      background-repeat: no-repeat;
      /*background-position: -50px 0*/
      background-position: 0 0
    }

    @media (-webkit-min-device-pixel-ratio: 2),(min-resolution:192dpi) {
      .page-link-to-github .github-icon {
        background-image:url('https://www.kotlincn.net/0_assets/static/css/com/layout/images/main-sprite@2x.png');
        background-size: 150px auto
      }
    }

    .page-link-to-github:hover .github-icon {
      /*background-position: 0 0*/
      background-position: -50px 0
    }
    .text {
      text-decoration: underline
    }
    .page-link-to-github .text {
      padding-left: 27px
    }
    .text {
      padding-right: 8px
    }
    .page-link-to-github {
      float: right;
      top: 4px
    }</style></head><body><a href="http://www.reactivemanifesto.org/" id=reactive-manifesto-banner><img style="border: 0; position: fixed; right: 0; top:0; z-index: 9000" src=https://d379ifj7s9wntv.cloudfront.net/reactivemanifesto/images/ribbons/we-are-reactive-black-right.png></a> <a id=skippy class="sr-only sr-only-focusable" href=#content><div class=container><span class=skiplink-text>Skip to main content</span></div></a><header class="navbar navbar-default navbar-static-top" id=top role=banner><div class=container><div class=navbar-header><button class="navbar-toggle collapsed" type=button data-toggle=collapse data-target=#vertx-navbar-collapse><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="https://vertx.tk/" class=navbar-brand><img alt=Brand src=https://vertx.tk/assets/logo-sm.png></a></div><nav class="collapse navbar-collapse" id=vertx-navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=http://start.vertx.io>Starter</a></li><li><a href="https://vertx.tk/download/">下载</a></li><li><a href="https://vertx.tk/docs/">文档</a></li><li><a href=https://github.com/vert-x3/wiki/wiki>维基</a></li><li><a href="https://vertx.tk/community/">社区</a></li><li><a href="https://vertx.tk/materials/">资料</a></li><li><a href="https://vertx.tk/blog/">博客</a></li></ul></nav></div></header><div class=container><div class="row blog"><article class="col-xs-12 blog-post"><h2 class=blog-post-title>Data-driven Apps made easy with Vert.x 3.4.0 and headless CMS Gentics Mesh</h2><p class=blog-post-meta>13th March 2017 by <a href=http://github.com/jotschi>jotschi</a></p><article><p>In this article, I would like to share why Vert.x is not only a robust foundation for the <a href="http://getmesh.io/">headless Content Management System Gentics Mesh</a> but also how the recent release 3.4.0 can be used to build a template-based web server with Gentics Mesh and handlebars.</p><p>A headless CMS focuses on delivering your content through an API and allows editors creating and managing that data through a web-based interface. Unlike a traditional CMS, it does not provide a specifically rendered output. The frontend part (the head) is literally cut off, allowing developers create websites, apps, or any other data-driven projects with their favourite technologies.</p><p><a href="http://vertx.io/blog/vert-x-3-4-0-is-released/">Vert.x 3.4.0</a> has just been released and it comes with a bunch of new features and bug fixes. I am especially excited about a small enhancement that changes the way in which the handlebars template engine handle their context data. Previously it was not possible to resolve Vert.x ‘s JsonObjects within the render context. With my enhancement <a href=https://github.com/vert-x3/vertx-web/pull/509>#509</a> - released in Vert.x 3.4.0 - it is now possible to access nested data from these objects within your templates. Previously this would have required flattening out each object and resolving it individually, which would have been very cumbersome.</p><p>I’m going to demonstrate this enhancement by showing how to build a product catalogue using Vert.x together with handlebars templates to render and serve the web pages. The product data is managed, stored and delivered by the CMS server as source for JSON data.</p><h2 id=clone-import-download-start-set-up-your-product-catalogue-website-quickly>Clone, Import, Download, Start - Set up your product catalogue website quickly</h2><p>Let’s quickly set up everything you need to run the website before I walk you through the code.</p><h3 id=1-clone-get-the-full-vert-x-with-gentics-mesh-example-from-github>1. Clone - <a href=https://github.com/gentics/mesh-vertx-example>Get the full Vert.x with Gentics Mesh example from Github</a></h3><p>Fire up your terminal and clone the example application to the directory of your choice.</p><pre><code class="hljs bash">git clone git@github.com:gentics/mesh-vertx-example.git</code></pre><h3 id=2-import-the-maven-project-in-your-favourite-ide>2. Import - The maven project in your favourite IDE</h3><p>The application is set up as a maven project and can be imported in Eclipse IDE via File → Import → Existing Maven Project</p><h3 id=3-download-get-the-headless-cms-gentics-mesh>3. Download - Get the headless CMS Gentics Mesh</h3><p><a href=http://getmesh.io/Download>Download the latest version of Gentics Mesh</a> and start the CMS with this one-liner</p><pre><code class="hljs bash">java -jar mesh-demo-<span class=hljs-number>0.6</span>.xx.jar</code></pre><p>For the current example we are going to use the read-only user credentials (<em>webclient:webclient</em>). If you want to play around with the demo data you can point your browser to <a href="http://localhost:8080/mesh-ui/">http://localhost:8080/mesh-ui/</a> to reach the Gentics Mesh user interface and use one of the <a href=http://getmesh.io/docs/beta/getting-started.html#_startup>available demo credentials</a> to login.</p><p><img class="img-responsive center-block" src=https://vertx.tk/assets/blog/vertx-mesh/mesh-ui.jpg title="Gentics Mesh User Interface"></p><h3 id=4-start-the-application-and-browse-the-product-catalogue>4. Start - The application and browse the product catalogue</h3><p>You can start the Vert.x web server by running Server.java.</p><p>That’s it - now you can access the product catalogue website in your browser: <a href=http://localhost:3000>http://localhost:3000</a></p><h2 id=why-vert-x-is-a-good-fit-for-gentics-mesh>Why Vert.x is a good fit for Gentics Mesh</h2><p>Before digging into the example, let me share a few thoughts on Vert.x and Gentics Mesh in combination. In this example Vert.x is part of the frontend stack in delivering the product catalogue website. But it might also be of interest to you that Vert.x is also used at the very heart of Gentics Mesh itself. The Gentics Mesh <a href="http://getmesh.io/docs/beta/raml/">REST API endpoints</a> are built on top of Vert.x as a core component.</p><p>The great thing about Vert.x is that there are a lot of default implementations for various tasks such as authentication, database integration, monitoring and clustering. It is possible to use one or more features and omit the rest and thus your application remains lightweight.</p><h2 id=curious-about-the-code->Curious about the code?</h2><p>Source: <a href=https://github.com/gentics/mesh-vertx-example>https://github.com/gentics/mesh-vertx-example</a></p><p>Now that everything is up and running let’s have a detailed look at the code.</p><p>A typical deployment unit for Vert.x is a <a href=http://vertx.io/docs/vertx-core/java/#_verticles>verticle</a>. In our case we use the verticle to bundle our code and run the web server within it. Once deployed, Vert.x will run the verticle and start the HTTP server code.</p><script src="https://gist.github.com/Jotschi/39fc0d3fcd45122eafe68d61bea4c120.js?file=main.java"></script><p>The <a href=http://getmesh.io/docs/beta/#_java_rest_client>Gentics Mesh REST client</a> is used to communicate with the Gentics Mesh server. The <a href="http://vertx.io/docs/vertx-web/java/">Vert.x web library</a> is used to set up our <a href=http://vertx.io/docs/vertx-web/java/#_basic_vert_x_web_concepts>HTTP Router</a>. As with other routing frameworks like <em>Silex</em> and <em>Express</em>, the router can be used to create routes for inbound HTTP requests. In our case we only need two routes. The main route which accepts the request will utilize the <a href=http://getmesh.io/docs/beta/#_webroot>Gentics Mesh Webroot API Endpoint</a> which is able to resolve content by a provided path. It will examine the response and add fields to the routing context.</p><p>The other route is chained and will take the previously prepared routing context and render the desired template using the <a href=http://vertx.io/docs/vertx-web/java/#_templates>handlebars template handler</a>.</p><script src="https://gist.github.com/Jotschi/39fc0d3fcd45122eafe68d61bea4c120.js?file=start.java"></script><p>First we can handle various special requests path such as “/“ for the welcome page. Or the typical favicon.ico request. Other requests are passed to the Webroot API handler method.</p><script src="https://gist.github.com/Jotschi/39fc0d3fcd45122eafe68d61bea4c120.js?file=pathHandler.java"></script><p>Once the path has been resolved to a <em>WebRootResponse</em> we can examine that data and determine whether it is a binary response or a JSON response. Binary responses may occur if the requested resource represents an image or any other binary data. Resolved binary contents are directly passed through to the client and the handlebars route is not invoked.</p><p>Examples</p><ul><li><a href="http://localhost:3000/">http://localhost:3000/</a> → welcome.hbs</li><li><a href=http://localhost:3000/Automobiles>http://localhost:3000/Automobiles</a> → category → productList.hbs</li><li><a href=http://localhost:3000/Automobiles/Tesla%20Roadster>http://localhost:3000/Automobiles/Tesla Roadster</a> → vehicle → productDetail.hbs</li><li><a href=http://localhost:3000/Vehicle%20Images/tesla-roadster.jpg>http://localhost:3000/Vehicle Images/tesla-roadster.jpg</a> → binary passthru</li></ul><p>JSON responses on the other hand are examined to determine the type of node which was located. A typical node response contains information about the schema used by the node. This will effectively determine the type of the located content (e.g.: category, vehicle).</p><script src="https://gist.github.com/Jotschi/39fc0d3fcd45122eafe68d61bea4c120.js?file=routeHandler.java"></script><p><img class="img-responsive center-block" src=https://vertx.tk/assets/blog/vertx-mesh/mesh-schemas.jpg title="Mesh Schemas"></p><p>The demo application serves different pages which correspond to the identified type. Take a look at the template sources within <em>src/main/resources/templates/</em> if you are interested in the <a href="http://handlebarsjs.com/">handlebars syntax</a>. The templates in the example should cover most common cases.</p><p><img class="img-responsive center-block" src=https://vertx.tk/assets/blog/vertx-mesh/mesh-vertx-templates.jpg title="Handlebars Template Overview"></p><p>The Mesh REST Client library internally makes use of the <a href=http://vertx.io/docs/vertx-core/java/#_creating_an_http_client>Vert.x core HTTP client</a>.</p><p><a href=https://github.com/ReactiveX/RxJava>RxJava</a> is being used to handle these async requests. This way we can combine all asynchronously requested Gentics Mesh resources (breadcrumb, list of products) and add the loaded data into the routing context.</p><p>The Vert.x example server loads JSON content from the Gentics Mesh server. The <em>JsonObject</em> is placed in the <a href=https://github.com/jknack/handlebars.java>handlebars</a> render context and the template can access all nested fields within.</p><p>This way it is possible to resolve any field within the handlebars template.</p><script src="https://gist.github.com/Jotschi/39fc0d3fcd45122eafe68d61bea4c120.js?file=template.example"></script><p>That’s it! Finally, we can invoke mvn clean package in order to package our webserver. The <a href="https://maven.apache.org/plugins/maven-shade-plugin/">maven-shade-plugin</a> will bundle everything and create an executable jar.</p><h2 id=what-s-next->What’s next?</h2><p>Future releases of Gentics Mesh will refine the Mesh REST Client API and provide a <a href="http://graphql.org/">GraphQL</a> which will reduce the JSON overhead. Using GraphQL will also reduce the amount of requests which need to be issued.</p><p>Thanks for reading. If you have any futher questions or feedback don’t hesitate to send me a tweet to <a href="https://twitter.com/Jotschi/">@Jotschi</a> or <a href="https://twitter.com/genticsmesh/">@genticsmesh</a>.</p></article></article></div><div class=row><div class=col-xs-12 id=disqus_thread></div></div><script>var disqus_config = function () {
  this.page.url = "https://vertx.tk/blog/data-driven-apps-made-easy-with-vert-x-3-4-0-and-headless-cms-gentics-mesh/";
  this.page.identifier = "/blog/data-driven-apps-made-easy-with-vert-x-3-4-0-and-headless-cms-gentics-mesh/";
  };
  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://vertx.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><footer><div class=container><div class=row><div class="col-xs-4 col-sm-4 col-md-2 col-lg-2"><h2>Eclipse Vert.x</h2><ul class=list-unstyled><li><a href="https://vertx.tk/">主页</a></li><li><a href="https://vertx.tk/download/">下载</a></li><li><a href="https://vertx.tk/docs/">文档</a></li><li><a href=https://github.com/vert-x3/wiki/wiki>维基</a></li><li><a href="https://vertx.tk/blog/">博客</a></li></ul></div><div class="col-xs-4 col-sm-4 col-md-2 col-lg-2"><h2>Community</h2><ul class=list-unstyled><li><a href="https://vertx.tk/community/">Help &amp; Contributors</a></li><li><a href="https://vertx.tk/materials/">Learning materials</a></li><li><a href=https://groups.google.com/forum/?fromgroups#!forum/vertx>User Group</a></li><li><a href=https://groups.google.com/forum/?fromgroups#!forum/vertx-dev>Developer Group</a></li></ul></div><div class="col-xs-4 col-sm-4 col-md-2 col-lg-2"><h2>Eclipse</h2><ul class=list-unstyled><li><a href="http://www.eclipse.org/">Eclipse Foundation</a></li><li><a href=https://eclipse.org/legal/privacy.php>Privacy Policy</a></li><li><a href=https://eclipse.org/legal/termsofuse.php>Terms of Use</a></li><li><a href=https://eclipse.org/legal/copyright.php>Copyright Agent</a></li><li><a href=http://www.eclipse.org/legal>Legal Resources</a></li></ul></div><div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 copyright"><p>Eclipse Vert.x is open source and dual-licensed under the <a href=http://www.eclipse.org/legal/epl-v20.html>Eclipse Public License 2.0</a> and <a href=https://www.apache.org/licenses/LICENSE-2.0.html>Apache License 2.0</a>.</p><p>This website is licensed under the <a href="http://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0 License</a>.<br>Design by <a href=https://www.michel-kraemer.com>Michel Kr&auml;mer</a>.</p><div class=row><div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-2"><a href=http://eclipse.org><img class="logo eclipse-logo" src=https://vertx.tk/assets/eclipse_logo_grey_small.png width=204 height=48></a></div><div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-0"><a href=http://cloudbees.com><img class="logo cloudbees-logo" src=https://vertx.tk/assets/Button-Built-on-CB-1-grey.png width=180 height=48></a></div><div class="col-sm-12 col-md-5 col-md-offset-7 jprofiler"><a href=http://www.ej-technologies.com/products/jprofiler/overview.html style=text-decoration:none><img class="logo jprofiler-logo" src=https://vertx.tk/assets/jprofiler-logo.png width=48 height=48><span class=jprofiler-logo>&nbsp; JPROFILER</span></a></div></div></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js></script><script src=https://vertx.tk/javascripts/bootstrap.min.js></script><script src=https://vertx.tk/javascripts/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=stylesheet type=text/css href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css"><script src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js></script><script>window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#64386b",
      "text": "#ffcdfd"
    },
    "button": {
      "background": "transparent",
      "text": "#f8a8ff",
      "border": "#f8a8ff"
    }
  },
  "content": {
    "message": "This website uses anonymous cookies to ensure we provide you the best experience. ",
    "link": "Opt out!",
    "href": "https://tools.google.com/dlpage/gaoptout/"
  }
})});</script></body></html>